{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "tool-exec-log.schema.json",
  "title": "ToolExecLog",
  "description": "Tool execution log for ablation dry-run phases. Stored at .mcp-client-data/ablations/runs/.../logs/{phase}/tool-exec-log.json",
  "type": "array",
  "items": { "$ref": "#/$defs/ToolExecLogEntry" },
  "$defs": {
    "ToolExecLogEntry": {
      "type": "object",
      "required": ["commandIndex", "command", "toolName", "args", "timestamp", "duration", "durationFormatted", "success"],
      "properties": {
        "commandIndex": {
          "type": "integer",
          "description": "Zero-based index of the command in the phase's command list"
        },
        "command": {
          "type": "string",
          "description": "Original command string (e.g. '@tool-exec:server__tool(arg=val)')"
        },
        "toolName": {
          "type": "string",
          "description": "Full tool name (server__tool)"
        },
        "args": {
          "type": "object",
          "description": "Parsed arguments passed to the tool",
          "additionalProperties": true
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "When this tool execution started"
        },
        "duration": {
          "type": "number",
          "description": "Execution time in milliseconds"
        },
        "durationFormatted": {
          "type": "string",
          "description": "Human-readable duration"
        },
        "success": {
          "type": "boolean",
          "description": "Whether the tool execution succeeded"
        },
        "displayText": {
          "type": "string",
          "description": "Tool output text (images replaced with placeholders)"
        },
        "error": {
          "type": "string",
          "description": "Error message if execution failed"
        },
        "isHook": {
          "type": "boolean",
          "description": "Whether this entry was triggered by a hook (not a direct command)"
        },
        "triggeredBy": {
          "type": "string",
          "description": "Tool name that triggered this hook execution"
        }
      }
    }
  }
}
